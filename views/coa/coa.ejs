<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.3.0/flowbite.min.js"></script>
<link rel="stylesheet" href="/stylesheets/coa.css">
  <title>COA</title>
 
</head>

<body>
  <!DOCTYPE html>
  <html>

  <head>
    <title>Home</title>

  </head>

  <body>
    <%- include("../loader") %>
    <%- include("../partials/qualityNav") %>
      <div class="details">
        <div class="main">
          <h1>Corporate</h1>
          <h3>Enter Below Details</h3>

          <form action="/coa/redirect" method="post">
            <label for="plant_code"> Enter Plant Code: </label>
            <input type="text" id="plant_code" name="plant_code" placeholder="Secure-Hyd(A), Vform-Hyd(B)" required />

            <label for="customer_gst"> Customer GST: </label>
            <input type="text" id="customer_gst" name="customer_gst" list="customerList" required />
            <datalist id="customerList"></datalist>
            <label for="invoice_no"> Invoice Number: </label>
            <input type="text" id="invoice_no" name="invoice_no" required />
            <label for="invoice_dt"> Invoice Date: </label>
            <input type="text" id="invoice_dt" name="invoice_dt" value="<%= new Date().toLocaleDateString('en-GB') %>"
              required />
            <label for="batch_number"> Batch Number: </label>
            <input type="number" id="batch_number" name="batch_number" list="batch" required />
            <datalist id="batch"></datalist>


            <label for="mfd">Date of Production: </label>
            <input type="text" id="mfd" name="mfd" required />
            <label for="qty">Total Boxes: </label>
            <input type="number" id="qty" name="qty" required />

            <div class="wrap loaderReq">
              <button type="submit">Next</button>
            </div>
          </form>


        </div>
      </div>
      <script>
        // Force uppercase for all inputs with class="uppercase"
        document.querySelectorAll("input.uppercase").forEach(input => {
          input.addEventListener("input", function () {
            this.value = this.value.toUpperCase();
          });
        });

        async function loadDatalist(apiUrl, datalistId) {
          try {
            const res = await fetch(apiUrl);
            const codes = await res.json();

            const datalist = document.getElementById(datalistId);
            datalist.innerHTML = "";

            codes.forEach((code) => {
              const option = document.createElement("option");
              option.value = code;
              datalist.appendChild(option);
            });
          } catch (err) {
            console.error(`Error loading ${datalistId}:`, err);
          }
        }

        // Load all datalists
        window.addEventListener("DOMContentLoaded", () => {
          loadDatalist("/api/customer", "customerList");
          loadDatalist("/api/batch", "batch");
        });

      </script>
       <script src="/javascripts/loader.js"></script>
  </body>

  </html>